<!DOCTYPE html>
<html  lang="en">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.0.0" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>Tag: J2EE - zixcon·blog</title>


    <meta property="og:type" content="website">
<meta property="og:title" content="zixcon·blog">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;tags&#x2F;J2EE&#x2F;index.html">
<meta property="og:site_name" content="zixcon·blog">
<meta property="og:locale" content="en">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;images&#x2F;og_image.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;images&#x2F;og_image.png">







<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="zixcon·blog" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    <a class="navbar-item" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;" target="_blank" rel="noopener">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main"><div class="card">
    <div class="card-content">
        <nav class="breadcrumb" aria-label="breadcrumbs">
        <ul>
            <li><a href="/tags">Tags</a></li>
            <li class="is-active"><a href="#" aria-current="page">J2EE</a></li>
        </ul>
        </nav>
    </div>
</div>

    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-01-10T02:32:50.000Z">2020-01-10</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a minute read (About 212 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/01/10/j2ee-stable/">如何保证系统的稳定性和高可用</a>
            
        </h1>
        <div class="content">
            <h1 id="如何保证系统的稳定性和高可用"><a href="#如何保证系统的稳定性和高可用" class="headerlink" title="如何保证系统的稳定性和高可用"></a>如何保证系统的稳定性和高可用</h1><p>##现象分析</p>
<p>​    在很长时间里，我们做的只是在原有系统上增加功能，架构上没有大调整。但是随着业务增长，就算我们系统没有任何发版升级，也会突然出现一些事故。</p>
<p><img src="j2ee-stable/j2ee-stable-1.jpg" alt></p>
<h2 id="发现问题"><a href="#发现问题" class="headerlink" title="发现问题"></a>发现问题</h2><p>从大方面说就是：外部的问题和自身的问题</p>
<p><img src="j2ee-stable/j2ee-stable-2.jpg" alt></p>
<p>​    值得一提的是：如果我们业务量没有上来，这些问题本不是问题。</p>
<p>##故障演练</p>
<p><img src="j2ee-stable/j2ee-stable-3.jpg" alt></p>
<h2 id="checklist"><a href="#checklist" class="headerlink" title="checklist"></a>checklist</h2><p><img src="j2ee-stable/j2ee-stable-4.jpg" alt></p>
<p>参照：</p>
<p><a href="http://www.360doc.com/content/18/0308/12/27972427_735360931.shtml" target="_blank" rel="noopener">不可容忍的4个9，业务高速增长下，<strong>如何保证系统的稳定性</strong>和高可用？</a></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-01-08T08:56:20.000Z">2020-01-08</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 90 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/01/08/j2ee-ioc/">j2ee-ioc</a>
            
        </h1>
        <div class="content">
            <h2 id="IOC"><a href="#IOC" class="headerlink" title="IOC"></a>IOC</h2><p>IOC，所谓控制反转，就是把原先我们代码里面需要实现的对象创建、依赖的代码，反转给容器来帮忙实现。</p>
<h2 id="实现机制"><a href="#实现机制" class="headerlink" title="实现机制"></a>实现机制</h2><p>IOC(控制反转)的实现建立在工厂模式、Java反射机制</p>
<p><a href="https://www.jianshu.com/p/3bfd916f2bb2" target="_blank" rel="noopener">设计模式之单例模式</a></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-01-07T07:15:41.000Z">2020-01-07</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 minutes read (About 1123 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/01/07/j2ee-dapper/">分布式链路追踪</a>
            
        </h1>
        <div class="content">
            <h1 id="分布式链路追踪"><a href="#分布式链路追踪" class="headerlink" title="分布式链路追踪"></a>分布式链路追踪</h1><p><a href="http://lidawn.github.io/2018/12/26/distribute-tracing/" target="_blank" rel="noopener">聊聊分布式链路追踪</a></p>
<p><a href="https://www.cnblogs.com/davidwang456/articles/9008893.html" target="_blank" rel="noopener">各大厂分布式链路跟踪系统架构对比</a></p>
<h2 id="什么是链路追踪"><a href="#什么是链路追踪" class="headerlink" title="什么是链路追踪"></a>什么是链路追踪</h2><p>分布式系统变得日趋复杂，越来越多的组件开始走向分布式化，如微服务、分布式数据库、分布式缓存等，使得后台服务构成了一种复杂的分布式网络。在服务能力提升的同时，复杂的网络结构也使问题定位更加困难。在一个请求在经过诸多服务过程中，出现了某一个调用失败的情况，查询具体的异常由哪一个服务引起的就变得十分抓狂，问题定位和处理效率是也会非常低。</p>
<p>分布式链路追踪就是将一次分布式请求还原成调用链路，将一次分布式请求的调用情况集中展示，比如各个服务节点上的耗时、请求具体到达哪台机器上、每个服务节点的请求状态等等。</p>
<h2 id="Dapper"><a href="#Dapper" class="headerlink" title="Dapper"></a>Dapper</h2><p>目前业界的链路追踪系统，如Twitter的<strong><a href="https://zipkin.io/" target="_blank" rel="noopener">Zipkin</a></strong>，Uber的<strong><a href="https://www.jaegertracing.io/" target="_blank" rel="noopener">Jaeger</a></strong>，阿里的<strong><a href="https://cn.aliyun.com/aliware/news/monitoringsolution" target="_blank" rel="noopener">鹰眼</a></strong>，美团的<strong><a href="https://tech.meituan.com/mt_mtrace.html" target="_blank" rel="noopener">Mtrace</a></strong>等都基本被启发于google发表的<strong><a href="http://static.googleusercontent.com/media/research.google.com/zh-CN//pubs/archive/36356.pdf" target="_blank" rel="noopener">Dapper</a></strong>。 Dapper阐述了分布式系统，特别是微服务架构中链路追踪的概念、数据表示、埋点、传递、收集、存储与展示等技术细节。</p>
<h3 id="Trace、Span、Annotations"><a href="#Trace、Span、Annotations" class="headerlink" title="Trace、Span、Annotations"></a>Trace、Span、Annotations</h3><p>为了实现链路追踪，dapper提出了trace，span，annotation的概念。<br>Trace的含义比较直观，就是链路，指一个请求经过后端所有服务的路径，可以用下面树状的图形表示。每一条链路都用一个全局唯一的traceid来标识。</p>
<h1 id="分布式调用跟踪系统的设计"><a href="#分布式调用跟踪系统的设计" class="headerlink" title="分布式调用跟踪系统的设计"></a>分布式调用跟踪系统的设计</h1><h3 id="（1）分布式调用跟踪系统的设计目标"><a href="#（1）分布式调用跟踪系统的设计目标" class="headerlink" title="（1）分布式调用跟踪系统的设计目标"></a>（1）分布式调用跟踪系统的设计目标</h3><p>低侵入性，应用透明：作为非业务组件，应当尽可能少侵入或者无侵入其他业务系统，对于使用方透明，减少开发人员的负担</p>
<p>低损耗：服务调用埋点本身会带来性能损耗，这就需要调用跟踪的低损耗，实际中还会通过配置采样率的方式，选择一部分请求去分析请求路径</p>
<p>大范围部署，扩展性：作为分布式系统的组件之一，一个优秀的调用跟踪系统必须支持分布式部署，具备良好的可扩展性</p>
<h3 id="（2）埋点和生成日志"><a href="#（2）埋点和生成日志" class="headerlink" title="（2）埋点和生成日志"></a>（2）埋点和生成日志</h3><p>埋点即系统在当前节点的上下文信息，可以分为客户端埋点、服务端埋点，以及客户端和服务端双向型埋点。埋点日志通常要包含以下内容：</p>
<p>TraceId、RPCId、调用的开始时间，调用类型，协议类型，调用方ip和端口，请求的服务名等信息；</p>
<p>调用耗时，调用结果，异常信息，消息报文等；</p>
<p>预留可扩展字段，为下一步扩展做准备；</p>
<h3 id="（3）抓取和存储日志"><a href="#（3）抓取和存储日志" class="headerlink" title="（3）抓取和存储日志"></a>（3）抓取和存储日志</h3><p>日志的采集和存储有许多开源的工具可以选择，一般来说，会使用离线+实时的方式去存储日志，主要是分布式日志采集的方式。典型的解决方案如Flume结合Kafka等MQ。</p>
<h3 id="（4）分析和统计调用链数据"><a href="#（4）分析和统计调用链数据" class="headerlink" title="（4）分析和统计调用链数据"></a>（4）分析和统计调用链数据</h3><p>一条调用链的日志散落在调用经过的各个服务器上，首先需要按 TraceId 汇总日志，然后按照RpcId 对调用链进行顺序整理。用链数据不要求百分之百准确，可以允许中间的部分日志丢失。</p>
<h3 id="（5）计算和展示"><a href="#（5）计算和展示" class="headerlink" title="（5）计算和展示"></a>（5）计算和展示</h3><p>汇总得到各个应用节点的调用链日志后，可以针对性的对各个业务线进行分析。需要对具体日志进行整理，进一步储存在HBase或者关系型数据库中，可以进行可视化的查询。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-12-31T03:36:10.000Z">2019-12-31</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 minutes read (About 695 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/12/31/j2ee-model-singleton/">singleton单例模式</a>
            
        </h1>
        <div class="content">
            <h1 id="不加锁实现"><a href="#不加锁实现" class="headerlink" title="不加锁实现"></a>不加锁实现</h1><h2 id="饿汉模式实现单例"><a href="#饿汉模式实现单例" class="headerlink" title="饿汉模式实现单例"></a>饿汉模式实现单例</h2><p>使用static来定义静态成员变量或静态代码，借助Class的类加载机制实现线程安全单例。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class Singleton &#123; </span><br><span class="line"></span><br><span class="line">    private static Singleton instance = new Singleton();</span><br><span class="line"></span><br><span class="line">    private Singleton ()&#123;&#125;</span><br><span class="line"></span><br><span class="line">    public static Singleton getInstance() &#123;</span><br><span class="line"></span><br><span class="line">      return instance;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="通过静态内部类来实现"><a href="#通过静态内部类来实现" class="headerlink" title="通过静态内部类来实现"></a>通过静态内部类来实现</h2><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Singleton &#123;</span><br><span class="line">    private static class SingletonHolder &#123;</span><br><span class="line">    private static final Singleton INSTANCE = new Singleton();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	private Singleton ()&#123;&#125;</span><br><span class="line"></span><br><span class="line">  public static final Singleton getInstance() &#123;</span><br><span class="line">    return SingletonHolder.INSTANCE;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用了lazy-loading。Singleton类被装载了，但是instance并没有立即初始化。因为SingletonHolder类没有被主动使用，只有显示通过调用getInstance方法时，才会显示装载SingletonHolder类，从而实例化instance。</p>
<h2 id="使用枚举的方式"><a href="#使用枚举的方式" class="headerlink" title="使用枚举的方式"></a>使用枚举的方式</h2><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public enum Singleton &#123;</span><br><span class="line"></span><br><span class="line">	INSTANCE;</span><br><span class="line">  public void whateverMethod() &#123;&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种方式是Effective Java作者Josh Bloch 提倡的方式，它不仅能避免多线程同步问题，而且还能防止反序列化重新创建新的对象，可谓是很坚强的壁垒。</p>
<p>面试官：以上几种答案，其实现原理都是利用借助了类加载的时候初始化单例。即借助了ClassLoader的线程安全机制。</p>
<p>所谓ClassLoader的线程安全机制，就是ClassLoader的loadClass方法在加载类的时候使用了synchronized关键字。也正是因为这样， 除非被重写，这个方法默认在整个装载过程中都是同步的，也就是保证了线程安全。</p>
<p>所以，以上各种方法，虽然并没有显示的使用synchronized，但是还是其底层实现原理还是用到了synchronized。</p>
<h2 id="使用CAS"><a href="#使用CAS" class="headerlink" title="使用CAS"></a>使用CAS</h2><p>CAS是项乐观锁技术，当多个线程尝试使用CAS同时更新同一个变量时，只有其中一个线程能更新变量的值，而其它线程都失败，失败的线程并不会被挂起，而是被告知这次竞争中失败，并可以再次尝试。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">public class Singleton &#123;</span><br><span class="line"></span><br><span class="line">    private static final AtomicReference INSTANCE = new AtomicReference();</span><br><span class="line"></span><br><span class="line">    private Singleton() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    public static Singleton getInstance() &#123;</span><br><span class="line"></span><br><span class="line">        for (;;) &#123;</span><br><span class="line"></span><br><span class="line">						Singleton singleton = INSTANCE.get();</span><br><span class="line"></span><br><span class="line">            if (null != singleton) &#123;</span><br><span class="line"></span><br><span class="line">                return singleton;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">						singleton = new Singleton();</span><br><span class="line"></span><br><span class="line">            if (INSTANCE.compareAndSet(null, singleton)) &#123;</span><br><span class="line"></span><br><span class="line">                return singleton;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用CAS的好处在于不需要使用传统的锁机制来保证线程安全,CAS是一种基于忙等待的算法,依赖底层硬件的实现,相对于锁它没有线程切换和阻塞的额外消耗,可以支持较大的并行度。</p>
<p>CAS的一个重要缺点在于如果忙等待一直执行不成功(一直在死循环中),会对CPU造成较大的执行开销。</p>
<p>另外，如果N个线程同时执行到singleton = new Singleton();的时候，会有大量对象创建，很可能导致内存溢出。</p>
<h1 id="加锁实现"><a href="#加锁实现" class="headerlink" title="加锁实现"></a>加锁实现</h1>
        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-12-31T01:41:22.000Z">2019-12-31</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 896 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/12/31/j2ee-%E5%B9%82%E7%AD%89/">接口幂等</a>
            
        </h1>
        <div class="content">
            <h1 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h1><p>幂等：任意多次执行所产生的影响均与一次执行的影响／效果相同</p>
<h1 id="场景／方案"><a href="#场景／方案" class="headerlink" title="场景／方案"></a>场景／方案</h1><p>唯一索引：防止新增脏数据。</p>
<blockquote>
<p> 常用于用户账户等</p>
</blockquote>
<p>Token机制：防止页面重复提交。</p>
<blockquote>
<p>原理上通过session token来实现的(<strong>也可以通过redis来实现</strong>)。当客户端请求页面时，服务器会生成一个随机数Token，并且将Token放置到session当中，然后将Token发给客户端（一般通过构造hidden表单）。<br>下次客户端提交请求时，Token会随着表单一起提交到服务器端。</p>
<p>服务器端第一次验证相同过后，会将session中的Token值更新下，若用户重复提交，第二次的验证判断将失败，因为用户提交的表单中的Token没变，但服务器端session中Token已经改变了。</p>
</blockquote>
<p>悲观锁: select * from table_xxx where id=’xxx’ for update; </p>
<blockquote>
<p>悲观锁使用时一般伴随事务一起使用，数据锁定时间可能会很长，根据实际情况选用；</p>
</blockquote>
<p>乐观锁: 乐观锁只是在更新数据那一刻锁表，其他时间不锁表，所以相对于悲观锁，效率更高。</p>
<blockquote>
<p>通过版本号实现update table_xxx set name=#name#,version=version+1 where version=#version#</p>
</blockquote>
<p>分布式锁: 通过第三方的系统(redis或zookeeper)，在业务系统插入数据或者更新数据，获取分布式锁，然后做操作，之后释放锁</p>
<blockquote>
<p>某个长流程处理过程要求不能并发执行，可以在流程执行之前根据某个标志(用户ID+后缀等)获取分布式锁，其他流程执行时获取锁就会失败，也就是同一时间该流程只能有一个能执行成功，执行完成后，释放分布式锁</p>
</blockquote>
<p>状态机幂等: </p>
<blockquote>
<p>业务单据上面有个状态，状态在不同的情况下会发生变更，一般情况下存在有限状态机，这时候，如果状态机已经处于下一个状态，这时候来了一个上一个状态的变更，理论上是不能够变更的，这样的话，保证了有限状态机的幂等</p>
</blockquote>
<p>对外提供接口的api如何保证幂等: [source来源，seq序列号]</p>
<blockquote>
<p>如银联提供的付款接口：需要接入商户提交付款请求时附带：source来源，seq序列号；source+seq在数据库里面做唯一索引，防止多次付款(并发时，只能处理一个请求) 。<br>重点：对外提供接口为了支持幂等调用，接口有两个字段必须传，一个是来源source，一个是来源方序列号seq，这个两个字段在提供方系统里面做联合唯一索引，这样当第三方调用时，先在本方系统里面查询一下，是否已经处理过，返回相应处理结果；没有处理过，进行相应处理，返回结果。注意，为了幂等友好，一定要先查询一下，是否处理过该笔业务，不查询直接插入业务系统，会报错，但实际已经处理了。</p>
</blockquote>
<p><a href="https://www.cnblogs.com/linjiqin/p/9678022.html" target="_blank" rel="noopener">高并发下的幂等解决方案</a></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-12-25T01:52:38.000Z">2019-12-25</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    16 minutes read (About 2411 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/12/25/j2ee-aop/">AOP原理及实现机制</a>
            
        </h1>
        <div class="content">
            <h1 id="AOP原理及实现机制"><a href="#AOP原理及实现机制" class="headerlink" title="AOP原理及实现机制"></a>AOP原理及实现机制</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>​    AOP即Aspect-Oriented Programming的缩写，中文意思是面向切面（或方面）编程。AOP实际上是一种编程思想，可以通过预编译方式和运行期动态代理实现在不修改源代码的情况下给程序动态统一添加功能的一种思想。</p>
<p>​    在传统的面向对象（Object-Oriented Progr amming，OOP）编程中，我们总是按照某种特定的执行顺序来实现业务流程，各个执行步骤之间是相互衔接、相互耦合的，对垂直切面关注度很高，横切面关注却很少，也很难关注。那么怎样可以解决这个问题呢？我们需要AOP，关注系统的“切面”，在适当的时候“拦截”程序的执行流程，把程序的预处理和后处理交给某个拦截器来完成。这样，业务流程就完全的从其它无关的代码中解放出来，各模块之间的分工更加明确，程序维护也变得容易多了。</p>
<p>​    AOP主要的<strong>意图</strong>是：允许通过分离应用的业务逻辑与系统级服务进行内聚性的开发。应用对象只实现业务逻辑即可，并不负责其它的系统级关注点。</p>
<p>​    AOP主要<strong>应用场景</strong>是：日志记录、跟踪、监控和优化，性能统计、优化，安全、权限控制，应用系统的异常捕捉及处理，事务处理，缓存，持久化，懒加载（Lazy loading），内容传递，调试，资源池，同步等等。</p>
<p><a href="http://www.360doc.com/content/16/0125/15/6789490_530457099.shtml" target="_blank" rel="noopener">AOP原理和基本概念</a></p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>​    AOP的发展目前已经历了两个阶段：</p>
<p>​    第一阶–静态AOP</p>
<p>​    第二阶段—动态AOP</p>
<p>​    静态AOP阶段，相应的横切关注点以Aspect形式实现之后，会通过特定的编译器，将实现后的Aspect编译并织入到系统的静态类中。比如AspectJ会使用ajc编译器将各个Aspect以Java字节码的形式编译到系统的各个功能模块中，已达到融合Aspect和Class的目的。</p>
<p>​    动态AOP阶段，AOP的织入过程在系统运行开始之后进行，而不是预先编译到系统中，可以在调整织入点以及织入逻辑单元的同时，不必变更系统其他的模块，甚至在系统运行的时候，也可以动态更改织入逻辑。</p>
<p>​    这两个阶段也为我们提供了通过预编译方式和运行期动态代理方式，实现了在不修改源代码的情况下给程序统一添加功能的目的。</p>
<blockquote>
<p><strong>AOP的相关概念</strong>：</p>
<p><strong>Joinpoint</strong>：在系统运行之前，AOP的功能模块都需要织入到OOP的功能模块中。所以，要进行这种织入过程，我们需要知道在系统的那些执行点上进行织入操作。这些将要在其上进行织入操作的系统执行点就称之为Joinpoint。（在Spring AOP 中仅支持方法级别的Joinpoint）</p>
<p><strong>Pointcut</strong>：代表的是Joinpoint的表达方式。将横切逻辑织入当前系统的过程中，需要参照Pointcut规定的Joinpoint信息，才可以知道应该往系统的哪些Joinpoint上织入横切逻辑。</p>
<p><strong>Pointcut指定系统中符合条件的一组Joinpoint。</strong></p>
<p><strong>Advice：</strong>是单一横切关注点逻辑的载体，代表将会织入到Joinpoint处的横切逻辑。如果将Aspect比作OOP中的Class，那么Advice就相当于Class中的Method。按照Advice在Joinpoint处执行时机的差异或者完成功能的不同，Advice可分成以下具体形式：Before Advice,After Advice(Afterreturning Advice、AfterThrowing Advice、AfterFinally Advice),Around Advice,Introduction。</p>
<p><strong>Aspect**</strong>：**是对体统中的横切关注点逻辑进行模块化封装的AOP概念实体。Aspect可以包含多个Pointcut以及相应的Advice定义。</p>
<p><strong>织入：</strong>完成横切关注点逻辑（以Aspect模块化的横切关注点）到OOP系统的过程。</p>
</blockquote>
<h2 id="实现机制"><a href="#实现机制" class="headerlink" title="实现机制"></a>实现机制</h2><p>​    AOP实现时有三种方式：<strong>生成子类字节码、生成代理类字节码、直接修改原类的字节码</strong></p>
<table>
<thead>
<tr>
<th align="left"><strong>类别</strong></th>
<th><strong>机制</strong></th>
<th><strong>原理</strong></th>
<th><strong>优点</strong></th>
<th align="left"><strong>缺点</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left">静态AOP</td>
<td>静态织入</td>
<td>在编译期，切面直接以字节码的形式编译到目标字节码文件中。</td>
<td>对系统无性能影响。</td>
<td align="left">灵活性不够。</td>
</tr>
<tr>
<td align="left">动态AOP</td>
<td>动态代理</td>
<td>在运行期，目标类加载后，为接口动态生成代理类，将切面植入到代理类中。</td>
<td>相对于静态AOP更加灵活。</td>
<td align="left">切入的关注点需要实现接口。对系统有一点性能影响。</td>
</tr>
<tr>
<td align="left">动态字节码生成</td>
<td>在运行期，目标类加载后，动态构建字节码文件生成目标类的子类，将切面逻辑加入到子类中。</td>
<td>没有接口也可以织入。</td>
<td>扩展类的实例方法为final时，则无法进行织入。</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">自定义类加载器</td>
<td>在运行期，目标加载前，将切面逻辑加到目标字节码里。</td>
<td>可以对绝大部分类进行织入。</td>
<td>代码中如果使用了其他类加载器，则这些类将不会被织入。</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">字节码转换</td>
<td>在运行期，所有类加载器加载字节码前，前进行拦截。</td>
<td>可以对所有类进行织入。</td>
<td></td>
<td align="left"></td>
</tr>
</tbody></table>
<h3 id="Java实现AOP机制"><a href="#Java实现AOP机制" class="headerlink" title="Java实现AOP机制"></a>Java实现AOP机制</h3><ol>
<li><p>动态代理</p>
<p>​    使用动态代理实现AOP需要有四个角色：被代理的类，被代理类的接口，织入器，和InvocationHandler。</p>
<p>​    主要通过<strong>代理模式</strong>实现，为实例对象通过代理模式创建了代理对象，访问这些实例对象必须要通过代理。</p>
<p>​    动态代理在运行期通过接口动态生成代理类，这为其带来了一定的灵活性，但这个灵活性却带来了两个问题，第一代理类必须实现一个接口，如果没实现接口会抛出一个异常。第二性能影响，因为动态代理使用反射的机制实现的，首先反射肯定比直接调用要慢</p>
<p>代表：JDK</p>
</li>
<li><p>动态字节码生成</p>
<p>​    在运行期间目标字节码加载后，生成目标类的子类，将切面逻辑加入到子类中，所以使用Cglib实现AOP不需要基于接口。</p>
<p>代表：Cglib</p>
</li>
<li><p>自定义类加载器</p>
<p>​    自定义类加载器，在类加载到JVM之前直接修改某些类的方法，并将切入逻辑织入到这个方法里，然后将修改后的字节码文件交给虚拟机运行<br>​    Javassist是一个编辑字节码的框架，可以让你很简单地操作字节码。它可以在运行期定义或修改Class。使用Javassist实现AOP的原理是在字节码加载前直接修改需要切入的方法。这比使用Cglib实现AOP更加高效，并且没太多限制。</p>
<p>​    自定义的类加载器实现AOP在性能上要优于动态代理和Cglib，因为它不会产生新类，但是它仍然存在一个问题，就是如果其他的类加载器来加载类的话，这些类将不会被拦截。</p>
<p>代表：Javassist</p>
</li>
<li><p>其他方式</p>
<p>​    自定义的类加载器实现AOP只能拦截自己加载的字节码，那么有没有一种方式能够监控所有类加载器加载字节码呢？有，使用Instrumentation，它是 Java 5 提供的新特性，使用 Instrumentation，开发者可以构建一个<strong>字节码转换器</strong>，在字节码加载前进行转换。</p>
</li>
</ol>
<p>###Spring的AOP</p>
<p>​    Spring默认采取的动态代理机制实现AOP，当动态代理不可用时（代理类无接口）会使用CGlib机制。</p>
<p>​    AOP(面向方面编程)的实现是建立在CGLib提供的类代理和jdk提供的接口代理</p>
<h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><ul>
<li>性能监控，在方法调用前后记录调用时间，方法执行太长或超时报警。</li>
<li>缓存代理，缓存某方法的返回值，下次执行该方法时，直接从缓存里获取。</li>
<li>软件破解，使用AOP修改软件的验证类的判断逻辑。</li>
<li>记录日志，在方法执行前后记录系统日志。</li>
<li>工作流系统，工作流系统需要将业务代码和流程引擎代码混合在一起执行，那么我们可以使用AOP将其分离，并动态挂接业务。</li>
<li>权限验证，方法执行前验证是否有权限执行当前方法，没有则抛出没有权限执行异常，由业务代码捕捉。</li>
</ul>
<p>​    </p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-11-29T08:50:21.000Z">2019-11-29</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    21 minutes read (About 3156 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/11/29/zk-paxos/">zookeeper学习之Paxos协议</a>
            
        </h1>
        <div class="content">
            <h4 id="拜占庭将军问题"><a href="#拜占庭将军问题" class="headerlink" title="拜占庭将军问题"></a>拜占庭将军问题</h4><blockquote>
<p>拜占庭位于如今的土耳其的伊斯坦布尔，是东罗马帝国的首都。由于当时拜占庭罗马帝国国土辽阔，为了防御目的，因此每个军队都分隔很远，将军与将军之间只能靠信差传消息。在战争的时候，拜占庭军队内所有将军必需达成 <strong>一致的共识</strong>，决定是否有赢的机会才去攻打敌人的阵营。但是，在军队内有可能存有叛徒和敌军的间谍，左右将军们的决定又扰乱整体军队的秩序，在进行共识时，结果并不代表大多数人的意见。这时候，在已知有成员不可靠的情况下，其余忠诚的将军在不受叛徒或间谍的影响下如何达成一致的协议，拜占庭问题就此形成。 </p>
</blockquote>
<p>​    拜占庭假设是对现实世界的模型化，由于硬件错误、网络拥塞或断开以及遭到恶意攻击，计算机和网络可能出现不可预料的行为。</p>
<p>​    在常见的分布式系统中，总会发生诸如<strong>机器宕机</strong>或<strong>网络异常</strong>（包括消息的延迟、丢失、重复、乱序，还有网络分区）等情况。</p>
<p>​    Paxos算法需要解决的问题就是如何在一个可能发生上述异常的分布式系统中，快速且正确地在集群内部对<strong>某个数据的值</strong>达成<strong>一致</strong>，并且保证不论发生以上任何异常，都不会破坏整个系统的一致性。</p>
<p><img src="./zk-paxos/zk_paxos_1.png" alt></p>
<p>历史／趣事：</p>
<blockquote>
<p>“Leslie Lamport也是用了长达9年的时间来完善这个算法的理论”–</p>
<p>•Lamport大牛在他Paxos的第一个版本早在1990年就提交给ACM TOCS Jnl.的评审委员会了,但是当时没有人理解他的算法 ,主编回执他的稿子建议他用数学而不是神话描述他的算法 他们才会考虑接受这篇paper 。</p>
<p>•Lamport大牛很生气 他有次就在一个会议上说:”为什么搞理论的这群人一点幽默感也没有呢?”, 他拒绝修改 而且withdraw了这篇文章。</p>
<p>•1996年微软的Butler Lampson在WDAG96上提出了重新审视这篇文章 因为他读懂了</p>
<p>•1997年MIT的Nancy Lynch在WDAG97上 根据原文重新改写了这篇文章，Lamport用数学形式化的定义并证明了Paxos。</p>
<p>•于是在1998年的ACM TOCS上 这篇迟到了9年的paper终于被接受了。</p>
<p>•后来2001年 Lamport大牛也作出了让步 他用简单的语言而不是神话故事 重述了原文 ，但是通篇还是没有数学符号， L大牛甚为固执 ，据他自己说 ，他检查过了自己的语言并没有歧义 ，不需要数学来描述。</p>
<p>Google Chubby的作者说：“这个世界上只有一种一致性算法，那就是 （Paxos</p>
</blockquote>
<p>时间线：</p>
<blockquote>
<p>[1]. LESLIE LAMPORT, ROBERT SHOSTAK, MARSHALL PEASE. <a href="http://research.microsoft.com/en-us/um/people/lamport/pubs/byz.pdf" target="_blank" rel="noopener">The Byzantine General Problem</a>. 1982<br> [2]. Leslie Lamport. <a href="http://research.microsoft.com/en-us/um/people/lamport/pubs/lamport-paxos.pdf" target="_blank" rel="noopener">The Part-Time Parliament</a>. 1998<br> [3]. Leslie Lamport. <a href="http://research.microsoft.com/en-us/um/people/lamport/pubs/paxos-simple.pdf" target="_blank" rel="noopener">Paxos Made Simple</a>. 2001<br> [4]. Diego Ongaro and John Ousterhout. <a href="https://ramcloud.stanford.edu/raft.pdf" target="_blank" rel="noopener">Raft Paper</a>. 2013<br> [5]. Raft Website. <a href="https://raft.github.io/" target="_blank" rel="noopener">The Raft Consensus Algorithm</a><br> [6]. Raft Demo. <a href="http://thesecretlivesofdata.com/raft/" target="_blank" rel="noopener">Raft Animate Demo</a></p>
</blockquote>
<h4 id="Paxos共识算法"><a href="#Paxos共识算法" class="headerlink" title="Paxos共识算法"></a>Paxos共识算法</h4><p><img src="./zk-paxos/zk_paxos_2.png" alt></p>
<p>​    Paxos本来是虚构故事中的一个小岛，议会通过表决来达成共识。但是议员可能离开，信使可能走丢，或者重复传递消息。对应到分布式系统的节点故障和网络故障。</p>
<blockquote>
<p> •假设议员要提议中午吃什么。如果有一个或者多个人同时提议，但一次只能通过一个提议，这就是Basic Paxos，是Paxos中最基础的协议。</p>
<p>•显然Basic Paxos是不够高效的，如果将Basic Paxos并行起来，同时提出多个提议，比如中午吃什么、吃完去哪里嗨皮、谁请客等提议，议员也可以同时通过多个提议。这就是Multi-Paxos协议。</p>
</blockquote>
<h4 id="Basic-Paxos"><a href="#Basic-Paxos" class="headerlink" title="Basic Paxos"></a>Basic Paxos</h4><p><strong>角色</strong></p>
<p>Paxos算法存在3种角色：Proposer、Acceptor、Learner，在实现中一个节点可以担任多个角色。</p>
<blockquote>
<p>•Proposer负责提出提案</p>
<p>•Acceptor负责对提案进行投票</p>
<p>•Learner获取投票结果，并帮忙传播</p>
<p>Learner不参与投票过程，为了简化描述，我们直接忽略掉这个角色。</p>
</blockquote>
<p><strong>算法</strong></p>
<blockquote>
<p>运行过程分为两个阶段</p>
<p>•Prepare阶段</p>
<p>•Accept阶段</p>
<p>•Proposer需要发出两次请求，Prepare请求和Accept请求。</p>
<p>•Acceptor根据其收集的信息，接受或者拒绝提案。</p>
</blockquote>
<p><strong>Prepare阶段</strong></p>
<blockquote>
<p>•Proposer选择一个提案编号n，发送Prepare(n)请求给超过半数（或更多）的Acceptor。</p>
<p>•Acceptor收到消息后，如果n比它之前见过的编号大，就回复这个消息，而且以后不会接受小于n的提案。另外，如果之前已经接受了小于n的提案，回复那个提案编号和内容给Proposer。</p>
</blockquote>
<p><strong>Accept阶段</strong></p>
<blockquote>
<p>•当Proposer收到超过半数的回复时，就可以发送Accept(n, value)请求了。 n就是自己的提案编号，value是Acceptor回复的最大提案编号对应的value，如果Acceptor没有回复任何提案，value就是Proposer自己的提案内容。</p>
<p>•Acceptor收到消息后，如果n大于等于之前见过的最大编号，就记录这个提案编号和内容，回复请求表示接受。</p>
<p>•当Proposer收到超过半数的回复时，说明自己的提案已经被接受。否则回到第一步重新发起提案。</p>
</blockquote>
<p><img src="./zk-paxos/zk_paxos_3.png" alt></p>
<h4 id="共识过程"><a href="#共识过程" class="headerlink" title="共识过程"></a>共识过程</h4><p><strong>情况</strong>1<strong>：提案已接受</strong></p>
<p><img src="./zk-paxos/zk_paxos_5.png" alt></p>
<blockquote>
<p>•这个过程表示，S1收到客户端的提案X，于是S1作为Proposer，给S1-S3发送Prepare(3.1)请求，由于Acceptor S1-S3没有接受过任何提案，所以接受该提案。然后Proposer S1-S3发送Accept(3.1, X)请求，提案X成功被接受。</p>
<p>•在提案X被接受后，S5收到客户端的提案Y，S5给S3-S5发送Prepare(4.5)请求。对S3来说，4.5比3.1大，且已经接受了X，它会回复这个提案 (3.1, X)。S5收到S3-S5的回复后，使用X替换自己的Y，于是发送Accept(4.5, X)请求。S3-S5接受提案。最终所有Acceptor达成一致，都拥有相同的值X。</p>
<p>•这种情况的结果是：<strong>新**</strong>Proposer<strong>**会使用已接受的提案</strong></p>
</blockquote>
<p><strong>情况</strong>2<strong>：提案未接受，新</strong>Proposer<strong>可见</strong></p>
<p><img src="./zk-paxos/zk_paxos_6.png" alt></p>
<blockquote>
<p>•S3接受了提案(3.1, X)，但S1-S2还没有收到请求。此时S3-S5收到Prepare(4.5)，S3会回复已经接受的提案(3.1, X)，S5将提案值Y替换成X，发送Accept(4.5, X)给S3-S5，对S3来说，编号4.5大于3.1，所以会接受这个提案。</p>
<p>•然后S1-S2接受Accept(3.1, X)，最终所有Acceptor达成一致。</p>
<p>•这种情况的结果是：<strong>新</strong>Proposer会使用已提交的值，两个提案都能成功</p>
</blockquote>
<p><strong>情况</strong>3： <strong>提案未接受，新</strong>Proposer<strong>不可见</strong> </p>
<p><img src="./zk-paxos/zk_paxos_7.png" alt></p>
<blockquote>
<p>•S1接受了提案(3.1, X)，S3先收到Prepare(4.5)，后收到Accept(3.1, X)，由于3.1小于4.5，会直接拒绝这个提案。所以提案X无法收到超过半数的回复，这个提案就被阻止了。提案Y可以顺利通过。</p>
<p>•这种情况的结果是：新<strong>Proposer</strong>使用自己的提案，旧提案被阻止</p>
</blockquote>
<p><strong>活锁</strong></p>
<p><img src="./zk-paxos/zk_paxos_8.png" alt></p>
<blockquote>
<p>•活锁发生的几率很小，但是会严重影响性能。就是两个或者多个Proposer在Prepare阶段发生互相抢占的情形。</p>
<p>•解决方案是Proposer失败之后给一个随机的等待时间，这样就减少同时请求的可能。</p>
</blockquote>
<h4 id="Multi-Paxos"><a href="#Multi-Paxos" class="headerlink" title="Multi-Paxos"></a>Multi-Paxos</h4><blockquote>
<p>•它会从Proposer中选出一个Leader，只由Leader提交Proposal，还可以省去Prepare阶段，减少了性能损失。当然，直接把Basic Paxos的多个Proposer的机制搬过来也是可以的，只是性能不够高。</p>
<p>•将Basic Paxos并行之后，就可以同时处理多个提案了，因此要能存储不同的提案，也要保证提案的顺序。</p>
</blockquote>
<p>上文提到的活锁，也可以使用Multi-Paxos来解决</p>
<p><strong>Multi-Paxos需要解决的问题</strong></p>
<p><strong>1. Leader选举</strong></p>
<blockquote>
<p>•一个最简单的选举方法，就是Server ID最大的当Leader。</p>
<p>•每个Server间隔T时间向其他Server发送心跳包，如果一个Server在2T时间内没有收到来自更高ID的心跳，那么它就成为Leader。</p>
<p>•其他Proposer，必须拒绝客户端的请求，或将请求转发给Leader。</p>
<p>•当然，还可以使用其他更复杂的选举方法，这里不再详述。</p>
</blockquote>
<p><strong>2.省略Prepare阶段</strong></p>
<blockquote>
<p>•Prepare的作用是阻止旧的提案，以及检查是否有已接受的提案值。</p>
<p>•当只有一个Leader发送提案的时候，Prepare是不会产生冲突的，可以省略Prepare阶段，这样就可以减少一半RPC请求。</p>
<p>•Prepare请求的逻辑修改为：</p>
<p>–Acceptor记录一个全局的最大提案编号</p>
<p>–回复最大提案编号，如果当前entry以及之后的所有entry都没有接受任何提案，回复noMoreAccepted</p>
<p>–当Leader收到超过半数的noMoreAccepted回复，之后就不需要Prepare阶段了，只需要发送Accept请求。直到Accept被拒绝，就重新需要Prepare阶段。</p>
</blockquote>
<p><strong>3. 完整信息流</strong></p>
<blockquote>
<p>•Basic Paxos只需超过半数的节点达成一致。但是在Multi-Paxos中，这种方式可能会使一些节点无法得到完整的entry信息。我们希望每个节点都拥有全部的信息。</p>
<p>•只有Proposer知道一个提案是否被接受了（根据收到的回复），而Acceptor无法得知此信息。</p>
</blockquote>
<p>第1个问题的解决方案很简单，就是Proposer给全部节点发送Accept请求。</p>
<p>第2个问题稍微复杂一些。首先，我们可以增加一个Success RPC，让Proposer显式地告诉Acceptor，哪个提案已经被接受了，这个是完全可行的，只不过还可以优化一下，减少请求次数。</p>
<p><strong>优化策略</strong></p>
<p><img src="./zk-paxos/zk_paxos_9.png" alt></p>
<blockquote>
<p>在Accept请求中，增加一个firstUnchosenIndex参数，表示Proposer的第一个未接受的Index，这个参数隐含的意思是，对该Proposer来说，小于Index的提案都已经被接受了。因此Acceptor可以利用这个信息，把小于Index的提案标记为已接受。</p>
<p>另外要注意的是，只能标记该Proposer的提案，因为如果发生Leader切换，不同的Proposer拥有的信息可能不同，不区分Proposer直接标记的话可能会不一致。</p>
</blockquote>
<blockquote>
<p>Proposer正在准备提交Index=2的Accept请求，0和1是已接受的提案，因此firstUnchosenIndex=2。当Acceptor收到请求后，比较Index，就可以将Dumplings提案标记为已接受。</p>
<p>由于之前提到的Leader切换的情况，仍然需要显式请求才能获得完整信息。在Acceptor回复Accept消息时，带上自己的firstUnchosenIndex。如果比Proposer的小，那么就需要发送Success(index, value)，Acceptor将收到的index标记为已接受，再回复新的firstUnchosenIndex，如此往复直到两者的index相等。</p>
</blockquote>
<p>这篇文章的分析来源于网络，具体没有记录来源，如有侵权，请联系我删除，谢谢！</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-11-29T08:29:47.000Z">2019-11-29</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    16 minutes read (About 2393 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/11/29/zk-pre/">zookeeper学习前瞻</a>
            
        </h1>
        <div class="content">
            <h4 id="ZK的由来"><a href="#ZK的由来" class="headerlink" title="ZK的由来"></a>ZK的由来</h4><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">What is ZooKeeper?</span><br><span class="line">       ZooKeeper is a centralized service for maintaining configuration information, naming, providing distributed synchronization, and providing group services. All of these kinds of services are used in some form or another by distributed applications. Each time they are implemented there is a lot of work that goes into fixing the bugs and race conditions that are inevitable. Because of the difficulty of implementing these kinds of services, applications initially usually skimp on them, which make them brittle in the presence of change and difficult to manage. Even when done correctly, different implementations of these services lead to management complexity when the applications are deployed.</span><br></pre></td></tr></table></figure>

<p>​    Zookeeper 分布式服务框架是Apache Hadoop 的一个子项目，它主要是用来解决分布式应用中经常遇到的一些数据管理问题，如：统一命名服务、状态同步服务、集群管理、分布式应用配置项的管理等。</p>
<blockquote>
<p>​    Zookeeper 最早起源于雅虎研究院的一个研究小组。在当时，研究人员发现，在雅虎内部很多大型系统基本都需要依赖一个类似的系统来进行分布式协调，但是这些系统往往都存在分布式单点问题。</p>
<p>​    所以，雅虎的开发人员就试图开发一个通用的无单点问题的分布式协调框架，以便让开发人员将精力集中在处理业务逻辑上。</p>
<p>​    关于“ZooKeeper”这个项目的名字，其实也有一段趣闻。在立项初期，考虑到之前内部很多项目都是使用动物的名字来命名的（例如著名的Pig项目)，雅虎的工程师希望给这个项目也取一个动物的名字。</p>
<p>​    时任研究院的首席科学家 Raghu Ramakrishnan 开玩笑地说：“在这样下去，我们这儿就变成动物园了！”</p>
<p>​    此话一出，大家纷纷表示就叫动物园管理员吧，因为各个以动物命名的分布式组件放在一起，雅虎的整个分布式系统看上去就像一个大型的动物园了。</p>
<p>​    而 Zookeeper 正好要用来进行分布式环境的协调，于是，Zookeeper 的名字也就由此诞生了。</p>
<p> ——《Paxos到  ZooKeeper 》</p>
</blockquote>
<h4 id="ZK的目标"><a href="#ZK的目标" class="headerlink" title="ZK的目标"></a>ZK的目标</h4><p>​     将那些复杂且容易出错的分布式一致性服务封装起来，构成一个高效可靠的原语集，并以一系列简单易用的接口提供给用户使用。   </p>
<blockquote>
<p>原语： </p>
<p>  操作系统或计算机网络用语范畴。它是由若干条指令组成的，用于完成一定功能的一个过程。具有不可分割性，即原语的执行必须是连续的，在执行过程中不允许被中断。</p>
</blockquote>
<p><strong>文件系统</strong></p>
<p><img src="./zk-pre/zk_pre_1.png" alt></p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">名称空间由 ZooKeeper 中的数据寄存器组成，称为 Znode，这些类似于文件和目录。</span><br><span class="line"></span><br><span class="line">与为存储设计的典型文件系统不同，ZooKeeper 数据保存在内存中，这意味着 ZooKeeper 可以实现高吞吐量和低延迟。</span><br></pre></td></tr></table></figure>

<blockquote>
<p>有四种类型的znode：</p>
<p>1、PERSISTENT-持久化目录节点</p>
<p>客户端与zookeeper断开连接后，该节点依旧存在</p>
<p>2、 PERSISTENT_SEQUENTIAL-持久化顺序编号目录节点</p>
<p>客户端与zookeeper断开连接后，该节点依旧存在，只是Zookeeper给该节点名称进行顺序编号</p>
<p>3、EPHEMERAL-临时目录节点</p>
<p>客户端与zookeeper断开连接后，该节点被删除</p>
<p>4、EPHEMERAL_SEQUENTIAL-临时顺序编号目录节点</p>
<p>客户端与zookeeper断开连接后，该节点被删除，只是Zookeeper给该节点名称进行顺序编号</p>
</blockquote>
<p><strong>通知机制</strong></p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Watcher （事件监听器） ： ZooKeeper 允许用户在指定节点上注册一些 Watcher，并且在一些特定事件触发的时候，ZooKeeper 服务端会将事件通知到感兴趣的客户端上去，该机制是 ZooKeeper 实现分布式协调服务的重要特性。</span><br></pre></td></tr></table></figure>



<h4 id="ZK的应用场景"><a href="#ZK的应用场景" class="headerlink" title="ZK的应用场景"></a>ZK的应用场景</h4><p><strong>命名服务</strong></p>
<blockquote>
<p>在zookeeper的文件系统里创建一个目录，即有唯一的path。在我们无法确定上游程序的部署机器时即可与下游程序约定好path，通过path即能互相探索发现</p>
</blockquote>
<p><strong>配置管理</strong></p>
<p><img src="./zk-pre/zk_pre_2.png" alt></p>
<blockquote>
<p>如果程序分散部署在多台机器上，要逐个改变配置就变得困难。好吧，现在把这些配置全部放到zookeeper上去，保存在 Zookeeper 的某个目录节点中，然后所有相关应用程序对这个目录节点进行监听，一旦配置信息发生变化，每个应用程序就会收到 Zookeeper 的通知，然后从 Zookeeper 获取新的配置信息应用到系统中就好。</p>
</blockquote>
<p><strong>集群管理</strong></p>
<p><img src="./zk-pre/zk_pre_3.png" alt></p>
<blockquote>
<p><strong>1.</strong>机器退出和加入</p>
<p> 所有机器约定在父目录GroupMembers下创建临时目录节点，然后监听父目录节点的子节点变化消息。一旦有机器挂掉，该机器与 zookeeper的连接断开，其所创建的临时目录节点被删除，所有其他机器都收到通知。新机器加入 也是类似，所有机器收到通知</p>
<p>2.选举master</p>
<p>举个最简单的例子：所有机器创建临时顺序编号目录节点，每次选取编号最小的机器作为master</p>
</blockquote>
<p><strong>分布式锁</strong></p>
<p><img src="./zk-pre/zk_pre_4.png" alt></p>
<blockquote>
<p>锁服务可以分为两类：一个是保持独占，另一个是控制时序。</p>
<p>独占锁：我们将zookeeper上的一个znode看作是一把锁，通过createznode的方式来实现。所有客户端都去创建 /distribute_lock 节点，最终成功创建的那个客户端也即拥有了这把锁。用完删除掉自己创建的distribute_lock 节点就释放出锁。</p>
<p>时序锁：预先创建 /distribute_lock 节点，所有客户端在它下面创建临时顺序编号目录节点，和选master一样，编号最小的获得锁，用完删除</p>
</blockquote>
<p><strong>队列管理</strong></p>
<blockquote>
<p>1.同步队列</p>
<p>​    当一个队列的成员都聚齐时，这个队列才可用，否则一直等待所有成员到达。</p>
<p>​    实现方案：在约定目录下创建临时目录节点，监听节点数目是否是我们要求的数目</p>
<p>2.FIFO 方式进行入队和出队操作</p>
<p>​    入列有编号，出列按编号</p>
</blockquote>
<p>ZK可以实现的功能远远不止这些，这里只列出一些经典使用场景</p>
<h4 id="ZK集群"><a href="#ZK集群" class="headerlink" title="ZK集群"></a>ZK集群</h4><p>Master/Slave 模式（主备模式）:</p>
<p>​    在这种模式中，通常 Master 服务器作为主服务器提供写服务，其他的 Slave 服务器从服务器通过异步复制的方式获取 Master 服务器最新的数据提供读服务。</p>
<p><strong>角色</strong></p>
<p><img src="./zk-pre/zk_pre_5.png" alt></p>
<blockquote>
<p>引入了Leader、Follower 和 Observer 三种角色。 </p>
<p>1.Leader 既可以为客户端提供写服务又能提供读服务</p>
<p>2.Follower 和  Observer 都只能提供读服务</p>
<p>3.Follower 和 Observer 唯一的区别在于 Observer 机器不参与 Leader 的选举过程，也不参与写操作的“过半写成功”策略，因此 Observer 机器可以在不影响写性能的情况下提升集群的读性能</p>
</blockquote>
<p><img src="./zk-pre/zk_pre_6.png" alt></p>
<h4 id="ZK一致性原理"><a href="#ZK一致性原理" class="headerlink" title="ZK一致性原理"></a>ZK一致性原理</h4><blockquote>
<p>ZK的一致性算法参照paxos算法实现，但不完全实现paxos算法。</p>
<p>ZAB 协议并不像 Paxos 算法那样，是一种通用的分布式一致性算法，它是一种特别为 ZooKeeper 设计的崩溃可恢复的原子消息广播算法。</p>
<p>ZAB（ZooKeeper Atomic Broadcast 原子广播）协议是为分布式协调服务 ZooKeeper 专门设计的一种支持崩溃恢复的原子广播协议。</p>
</blockquote>
<p>ZAB 协议包括两种基本的模式，分别是<strong>崩溃恢复</strong>和<strong>消息广播</strong>。</p>
<blockquote>
<p>当整个服务框架在启动过程中，或是当 Leader 服务器出现网络中断、崩溃退出与重启等异常情况时，ZAB 协议就会进入恢复模式并选举产生新的 Leader 服务器。</p>
<p>当选举产生了新的 Leader 服务器，同时集群中已经有过半的机器与该 Leader 服务器完成了状态同步之后，ZAB 协议就会退出恢复模式。</p>
<p>其中，所谓的状态同步是指数据同步，用来保证集群中存在过半的机器能够和 Leader 服务器的数据状态保持一致。</p>
<p>当集群中已经有过半的 Follower 服务器完成了和 Leader 服务器的状态同步，那么整个服务框架就可以进人消息广播模式了。</p>
<p>当一台同样遵守 ZAB 协议的服务器启动后加入到集群中时，如果此时集群中已经存在一个 Leader 服务器在负责进行消息广播。</p>
<p>那么新加入的服务器就会自觉地进人数据恢复模式：找到 Leader 所在的服务器，并与其进行数据同步，然后一起参与到消息广播流程中去。</p>
</blockquote>
<p>请看下文paxos解读</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-11-29T05:54:08.000Z">2019-11-29</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    17 minutes read (About 2617 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/11/29/j2ee-log/">LOG日志桥接关系</a>
            
        </h1>
        <div class="content">
            <p><img src="./j2ee-log/log_1.png" alt></p>
<p>这里思考几个问题：</p>
<p>1.日志框架是给Java应用提供的方便进行记录日志的，那为什么又不让在应用中直接使用其API呢？</p>
<p>2.这里面推崇使用的SLF4J是什么呢？</p>
<p>3.所谓的门面模式又是什么东西呢？</p>
<p>4.它是怎么做到统一的呢？</p>
<h4 id="门面模式"><a href="#门面模式" class="headerlink" title="门面模式"></a>门面模式</h4><p><strong>迪米特法则</strong>：<strong>talk only to your immediate friends</strong></p>
<pre><code>迪米特法则的[初衷](https://baike.baidu.com/item/初衷)在于降低类之间的[耦合](https://baike.baidu.com/item/耦合/2821124)。由于每个类尽量减少对其他类的依赖，因此，很容易使得系统的功能模块功能独立，相互之间不存在（或很少有）依赖关系。

迪米特法[友元类](https://baike.baidu.com/item/友元类/518734)转达。因此，应用迪米特法则有可能造成的一个后果就是：系统中存在大量的中介类，这些类之所以存在完全是为了传递类之间的相互调用关系这在一定程度上增加了系统的复杂度。</code></pre><p><img src="./j2ee-log/log_2.png" alt></p>
<p>​    外观模式创造出一个外观对象，将客户端所涉及的属于一个子系统的协作伙伴的数量减到最少，使得客户端与子系统内部的对象的相互作用被外观对象所取代。外观类充当了客户类与子系统类之间的“第三者”，降低了客户类与子系统类之间的耦合度  </p>
<p>更形象点：</p>
<p><img src="./j2ee-log/log_3.png" alt></p>
<p><img src="./j2ee-log/log_4.png" alt></p>
<p><strong>优点</strong>:</p>
<p>　　<strong>-</strong> <strong>松耦合</strong></p>
<p>　　用户与子系统解耦，屏蔽子系统；可以提高子系统的独立性； </p>
<p>　　<strong>-</strong> <strong>简单易用</strong></p>
<p>　　简化用户与子系统的依赖关系；<br>    用户只与门面对接，有统一的入口；不需要知道所有子系统及内部构造；</p>
<p>　　<strong>-</strong> <strong>更好的划分访问层次</strong></p>
<p>　　有些方法是对系统外的，有些方法是系统内部相互交互的使用的。子系统把那些暴露给外部的功能集中到门面中，这样就可以实现客户端的使用，很好的隐藏了子系统内部的细节。</p>
<p><strong>缺点</strong>:</p>
<pre><code>不能很好地限制客户使用子系统类，如果对客户访问子系统类做太多的限制则减少了可变性和灵活性。

在不引入抽象外观类的情况下，增加新的子系统可能需要修改外观类或客户端的源代码，违背了“开闭原则”。</code></pre><p>开闭原则两个主要特征：</p>
<p>（1）对于扩展是开放的（Open for extension）。</p>
<p>（2）对于修改是关闭的（Closed for modification）。</p>
<p><strong>错误使用行为</strong></p>
<pre><code>不要通过继承一个外观类在子系统中加入新的行为，这种做法是错误的。

外观模式的用意是为子系统提供一个集中化和简化的沟通渠道，而不是向子系统加入新的行为，新的行为的增加应该通过修改原有子系统类或增加新的子系统类来实现，不能通过外观类来实现。</code></pre><h4 id="Log日志框架关系"><a href="#Log日志框架关系" class="headerlink" title="Log日志框架关系"></a>Log日志框架关系</h4><ol>
<li>1996年早期，欧洲安全电子市场项目组决定编写它自己的程序跟踪API(Tracing API)。经过不断的完善，这个API终于成为一个十分受欢迎的Java日志软件包，即Log4j。后来Log4j成为Apache基金会项目中的一员。</li>
<li>期间Log4j近乎成了Java社区的日志标准。据说Apache基金会还曾经建议Sun引入Log4j到java的标准库中，但Sun拒绝了。</li>
<li>2002年Java1.4发布，Sun推出了自己的日志库JUL(Java Util Logging),其实现基本模仿了Log4j的实现。在JUL出来以前，Log4j就已经成为一项成熟的技术，使得Log4j在选择上占据了一定的优势。</li>
<li>接着，Apache推出了Jakarta Commons Logging，JCL只是定义了一套日志接口(其内部也提供一个Simple Log的简单实现)，支持运行时动态加载日志组件的实现，也就是说，在你应用代码里，只需调用Commons Logging的接口，底层实现可以是Log4j，也可以是Java Util Logging。</li>
<li>后来(2006年)，Ceki Gülcü离开了Apache。然后先后创建了Slf4j(日志门面接口，类似于Commons Logging)和Logback(Slf4j的实现)两个项目，并回瑞典创建了QOS公司，QOS官网上是这样描述Logback的：The Generic，Reliable Fast&amp;Flexible Logging Framework(一个通用，可靠，快速且灵活的日志框架)。从此以后，Java日志领域被划分为两大阵营：Commons Logging阵营和Slf4j阵营。</li>
<li>2012年，Apache重写了Log4j 1.x，成立了新的项目Log4j 2</li>
</ol>
<p><img src="./j2ee-log/log_5.png" alt></p>
<p>Commons Logging和Slf4j是日志门面</p>
<p>Log4j和Logback则是具体的日志实现方案</p>
<p><img src="./j2ee-log/log_6.png" alt></p>
<p>这里可以看出分为三个层次：</p>
<p>抽象层：提供应用直接调用api</p>
<p>适配层：提供于抽象层和实现层的适配实现</p>
<p>实现层：api的实现</p>
<p><strong>通过log4j-slf4j-impl来看是如何桥接</strong></p>
<p><img src="./j2ee-log/log_7.png" alt></p>
<table>
<thead>
<tr>
<th>jar包名</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><strong>slf4j-log4j12-1.7.13.jar</strong></td>
<td>Log4j1.2版本的桥接器，你需要将Log4j.jar加入Classpath。</td>
</tr>
<tr>
<td><strong>slf4j-jdk14-1.7.13.jar</strong></td>
<td>java.util.logging的桥接器，Jdk原生日志框架。</td>
</tr>
<tr>
<td><strong>slf4j-nop-1.7.13.jar</strong></td>
<td>NOP桥接器，默默丢弃一切日志。</td>
</tr>
<tr>
<td><strong>slf4j-simple-1.7.13.jar</strong></td>
<td>一个简单实现的桥接器，该实现输出所有事件到System.err.  只有Info以及高于该级别的消息被打印，在小型应用中它也许是有用的。</td>
</tr>
<tr>
<td><strong>slf4j-jcl-1.7.13.jar</strong></td>
<td>Jakarta Commons Logging 的桥接器.  这个桥接器将Slf4j所有日志委派给Jcl。</td>
</tr>
<tr>
<td><strong>logback-classic-1.0.13.jar(requires  logback-core-1.0.13.jar)</strong></td>
<td>Slf4j的原生实现，Logback直接实现了Slf4j的接口，因此使用Slf4j与Logback的结合使用也意味更小的内存与计算开销</td>
</tr>
</tbody></table>
<p><strong>如何将日志框架指向SLF4J</strong>：</p>
<table>
<thead>
<tr>
<th>jar包名</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td><strong>log4j-over-slf4j.jar</strong></td>
<td>将Log4j  1重定向到Slf4j</td>
</tr>
<tr>
<td><strong>jcl-over-slf4j.jar</strong></td>
<td>将Commons  Logging里的Simple  Logger重定向到slf4j</td>
</tr>
<tr>
<td><strong>jul-to-slf4j.jar</strong></td>
<td>将Java  Util  Logging重定向到Slf4j</td>
</tr>
<tr>
<td><strong>log4j-to-slf4j</strong></td>
<td>log4j 2 API到slf4j的适配</td>
</tr>
</tbody></table>
<p><strong>Slf4j/log4j2集成举例</strong></p>
<p>如果我们在系统中需要使用slf4j和log4j2来进行日志输出的话，我们需要引入下面的jar包：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">log4j2核心jar包：log4j-api-2.7.jar和log4j-core-2.7.jar</span><br><span class="line">slf4j核心jar包：slf4j-api-1.6.4.jar</span><br><span class="line">slf4j与log4j2的桥接包：log4j-slf4j-impl-2.7.jar，这个包的作用就是使用slf4j的api，但是底层实现是基于log4j2</span><br></pre></td></tr></table></figure>

<p><strong>死循环问题</strong></p>
<table>
<thead>
<tr>
<th>多个日志jar包形成死循环的条件</th>
<th>产生原因</th>
</tr>
</thead>
<tbody><tr>
<td><strong>log4j-over-slf4j.jar和slf4j-log4j12.jar</strong></td>
<td>由于slf4j-log4j12.jar的存在会将所有日志调用委托给log4j。但由于同时由于log4j-over-slf4j.jar的存在，会将所有对log4j  api的调用委托给相应等值的slf4j,所以log4j-over-slf4j.jar和slf4j-log4j12.jar同时存在会形成死循环</td>
</tr>
<tr>
<td><strong>jcl-over-slf4j</strong> <strong>与</strong> <strong>slf4j-jcl</strong></td>
<td>Jcl-over-slf4j  : commons-logging切换到slf4j  slf4j-jcl  : slf4j切换到commons-logging</td>
</tr>
<tr>
<td><strong>jul-to-slf4j.jar和slf4j-jdk14.jar</strong></td>
<td>由于slf4j-jdk14.jar的存在会将所有日志调用委托给jdk的log。但由于同时jul-to-slf4j.jar的存在，会将所有对jul api的调用委托给相应等值的slf4j，所以jul-to-slf4j.jar和slf4j-jdk14.jar同时存在会形成死循环</td>
</tr>
</tbody></table>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">死循环日志：</span><br><span class="line">SLF4J: Detected both log4j-over-slf4j.jar AND slf4j-log4j12.jar on the class path, preempting StackOverflowError.   </span><br><span class="line">SLF4J: See also http://www.slf4j.org/codes.html#log4jDelegationLoop for more details.</span><br></pre></td></tr></table></figure>

<p>看到这里，是不是很头大，这么多工具类，怎么管理这些包之间的关系，使得日志的使用情况和预期一致，并且规避日志引起的问题呢？</p>
<h4 id="日志依赖包管理方案"><a href="#日志依赖包管理方案" class="headerlink" title="日志依赖包管理方案"></a><strong>日志依赖包管理方案</strong></h4><p><strong>方案1:采用maven的exclusion方案</strong>  </p>
<p><img src="./j2ee-log/log_8.png" alt></p>
<p>优点是exclusion是maven原生提供的</p>
<p>不足之处是如果有多个组件都依赖了commons-logging，则需要在很多处增加，使用起来不太方便</p>
<p><strong>方案2: 在maven声明commons-logging的scope为provided</strong>  </p>
<p>​    这种方案在调试代码时还是有可能导致IDE将commons-logging放置在classpath下，从而导致程序运行时出现异常</p>
<p><strong>方案3:在maven私服中增加虚拟的版本号</strong> 【建议方案】</p>
<p><img src="./j2ee-log/log_9.png" alt></p>
<p>​    好处是声明方式比较简单，用IDE调试代码时也不会出现问题，不足之处是maven中央仓库中是不存在的，需要发布到自己的maven私服中。</p>
<p>​    但是，这种方式得注意，由于maven的加载关系，必须得把此配置声明放在顶级pom文件中，保证优先加载此空jar包</p>
<p><strong>虚拟版本号原理</strong></p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Maven 解析 pom.xml 文件时，同一个 jar 包只会保留一个，这样有效的避免因引入两个 jar 包导致的工程运行不稳定性。</span><br><span class="line"></span><br><span class="line">  	举例：假设 A-&gt;B-&gt;C-&gt;D1, E-&gt;F-&gt;D2，D1,D2 分别为 D 的不同版本。那么会引入哪个版本？</span><br></pre></td></tr></table></figure>

<p>  <strong>Maven</strong> <strong>默认处理策略</strong></p>
<ol>
<li><p><strong>最短路径优先</strong></p>
<pre><code>Maven 面对 D1 和 D2 时，会默认选择最短路径的那个 jar 包，即 D2。E-&gt;F-&gt;D2 比 A-&gt;B-&gt;C-&gt;D1 路径短 1。</code></pre></li>
<li><p><strong>最先声明优先</strong>     </p>
</li>
</ol>
<p>​        如果路径一样的话，举个： A-&gt;B-&gt;C1, E-&gt;F-&gt;C2 ，两个依赖路径长度都是 2，那么就选择最先声明。</p>

        </div>
        
        
        
    </div>
</div>








</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="" src="/images/avatar.png" alt="Your name">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        Your name
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Your title
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Your location</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <a href="/archives">
                        <p class="title has-text-weight-normal">
                            36
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <a href="/categories">
                        <p class="title has-text-weight-normal">
                            0
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <a href="/tags">
                        <p class="title has-text-weight-normal">
                            21
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/ppoffice" target="_blank">
                Follow</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Github" href="https://github.com/ppoffice">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Facebook" href="https://facebook.com">
                
                <i class="fab fa-facebook"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Twitter" href="https://twitter.com">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Dribbble" href="https://dribbble.com">
                
                <i class="fab fa-dribbble"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Links
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://hexo.io" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Hexo</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">hexo.io</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://github.com/ppoffice" target="_blank">
                    <span class="level-left">
                        <span class="level-item">PPOffice</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>

    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            
            </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/tags/DUBBO/" style="font-size: 10px;">DUBBO</a> <a href="/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/tags/I-O/" style="font-size: 12.5px;">I/O</a> <a href="/tags/J2EE/" style="font-size: 20px;">J2EE</a> <a href="/tags/JAVA/" style="font-size: 15px;">JAVA</a> <a href="/tags/JDK/" style="font-size: 15px;">JDK</a> <a href="/tags/JVM/" style="font-size: 12.5px;">JVM</a> <a href="/tags/LINUX/" style="font-size: 17.5px;">LINUX</a> <a href="/tags/LOG/" style="font-size: 10px;">LOG</a> <a href="/tags/MOCK/" style="font-size: 10px;">MOCK</a> <a href="/tags/MQ/" style="font-size: 10px;">MQ</a> <a href="/tags/MYSQL/" style="font-size: 12.5px;">MYSQL</a> <a href="/tags/NETTY/" style="font-size: 10px;">NETTY</a> <a href="/tags/REDIS/" style="font-size: 17.5px;">REDIS</a> <a href="/tags/SPRING/" style="font-size: 10px;">SPRING</a> <a href="/tags/THREAD/" style="font-size: 10px;">THREAD</a> <a href="/tags/ZK/" style="font-size: 15px;">ZK</a> <a href="/tags/eureka/" style="font-size: 10px;">eureka</a> <a href="/tags/linux/" style="font-size: 10px;">linux </a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 10px;">算法</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 12.5px;">设计模式</a>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2020/01/15/mysql-in-exists/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="in exists 区别">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-15T06:33:11.000Z">2020-01-15</time></div>
                    <a href="/2020/01/15/mysql-in-exists/" class="title has-link-black-ter is-size-6 has-text-weight-normal">in exists 区别</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/10/j2ee-stable/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="如何保证系统的稳定性和高可用">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-10T02:32:50.000Z">2020-01-10</time></div>
                    <a href="/2020/01/10/j2ee-stable/" class="title has-link-black-ter is-size-6 has-text-weight-normal">如何保证系统的稳定性和高可用</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/09/jdk-synchronized/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="synchronized">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-09T09:08:31.000Z">2020-01-09</time></div>
                    <a href="/2020/01/09/jdk-synchronized/" class="title has-link-black-ter is-size-6 has-text-weight-normal">synchronized</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/08/j2ee-ioc/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="j2ee-ioc">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-08T08:56:20.000Z">2020-01-08</time></div>
                    <a href="/2020/01/08/j2ee-ioc/" class="title has-link-black-ter is-size-6 has-text-weight-normal">j2ee-ioc</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/08/java-threadlocal/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="java-threadlocal">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-08T02:58:20.000Z">2020-01-08</time></div>
                    <a href="/2020/01/08/java-threadlocal/" class="title has-link-black-ter is-size-6 has-text-weight-normal">java-threadlocal</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">January 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">11</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">December 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">13</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/11/">
                <span class="level-start">
                    <span class="level-item">November 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">12</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Tags
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/DUBBO/">
                        <span class="tag">DUBBO</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/HTTP/">
                        <span class="tag">HTTP</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/I-O/">
                        <span class="tag">I/O</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/J2EE/">
                        <span class="tag">J2EE</span>
                        <span class="tag is-grey">9</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JAVA/">
                        <span class="tag">JAVA</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JDK/">
                        <span class="tag">JDK</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JVM/">
                        <span class="tag">JVM</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/LINUX/">
                        <span class="tag">LINUX</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/LOG/">
                        <span class="tag">LOG</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MOCK/">
                        <span class="tag">MOCK</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MQ/">
                        <span class="tag">MQ</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MYSQL/">
                        <span class="tag">MYSQL</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/NETTY/">
                        <span class="tag">NETTY</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/REDIS/">
                        <span class="tag">REDIS</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/SPRING/">
                        <span class="tag">SPRING</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/THREAD/">
                        <span class="tag">THREAD</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ZK/">
                        <span class="tag">ZK</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/eureka/">
                        <span class="tag">eureka</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/linux/">
                        <span class="tag">linux </span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%AE%97%E6%B3%95/">
                        <span class="tag">算法</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
                        <span class="tag">设计模式</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recent
        </h3>
        
        <article class="media">
            
            <a href="/2020/01/15/mysql-in-exists/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="in exists 区别">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-15T06:33:11.000Z">2020-01-15</time></div>
                    <a href="/2020/01/15/mysql-in-exists/" class="title has-link-black-ter is-size-6 has-text-weight-normal">in exists 区别</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/10/j2ee-stable/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="如何保证系统的稳定性和高可用">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-10T02:32:50.000Z">2020-01-10</time></div>
                    <a href="/2020/01/10/j2ee-stable/" class="title has-link-black-ter is-size-6 has-text-weight-normal">如何保证系统的稳定性和高可用</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/09/jdk-synchronized/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="synchronized">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-09T09:08:31.000Z">2020-01-09</time></div>
                    <a href="/2020/01/09/jdk-synchronized/" class="title has-link-black-ter is-size-6 has-text-weight-normal">synchronized</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/08/j2ee-ioc/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="j2ee-ioc">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-08T08:56:20.000Z">2020-01-08</time></div>
                    <a href="/2020/01/08/j2ee-ioc/" class="title has-link-black-ter is-size-6 has-text-weight-normal">j2ee-ioc</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/01/08/java-threadlocal/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="java-threadlocal">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-01-08T02:58:20.000Z">2020-01-08</time></div>
                    <a href="/2020/01/08/java-threadlocal/" class="title has-link-black-ter is-size-6 has-text-weight-normal">java-threadlocal</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">January 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">11</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">December 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">13</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/11/">
                <span class="level-start">
                    <span class="level-item">November 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">12</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Tags
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/DUBBO/">
                        <span class="tag">DUBBO</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/HTTP/">
                        <span class="tag">HTTP</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/I-O/">
                        <span class="tag">I/O</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/J2EE/">
                        <span class="tag">J2EE</span>
                        <span class="tag is-grey">9</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JAVA/">
                        <span class="tag">JAVA</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JDK/">
                        <span class="tag">JDK</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/JVM/">
                        <span class="tag">JVM</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/LINUX/">
                        <span class="tag">LINUX</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/LOG/">
                        <span class="tag">LOG</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MOCK/">
                        <span class="tag">MOCK</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MQ/">
                        <span class="tag">MQ</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/MYSQL/">
                        <span class="tag">MYSQL</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/NETTY/">
                        <span class="tag">NETTY</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/REDIS/">
                        <span class="tag">REDIS</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/SPRING/">
                        <span class="tag">SPRING</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/THREAD/">
                        <span class="tag">THREAD</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ZK/">
                        <span class="tag">ZK</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/eureka/">
                        <span class="tag">eureka</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/linux/">
                        <span class="tag">linux </span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%AE%97%E6%B3%95/">
                        <span class="tag">算法</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
                        <span class="tag">设计模式</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.svg" alt="zixcon·blog" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2020 John Doe&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>

<script>
var IcarusThemeSettings = {
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>



    
    
<script src="/js/animation.js"></script>

    
    
<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>

    
    
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/" target="_blank" rel="noopener">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>

    
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>
    
    
<a id="back-to-top" title="Back to Top" href="javascript:;" target="_blank" rel="noopener">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>

    
    
    
    
    
    
    
    
    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>